import{_ as e}from"./index.e76cf722.js";import{_ as A,d as a,r as t,j as E,i,o as l,h as n,m as s,p as o,u as B,a as r,w as C,q as c,c as D,F as d,B as u}from"./index.0aa131dc.js";import"./assign.d33290b3.js";import"./index.7d12c3dd.js";var p=A(a({__name:"dynamicRules",setup(A,{expose:a}){const p=t(),y=E({tableData:[{name:"wing",isAge:!1,like:void 0},{name:"ring",isAge:!0,like:"sing"}],columns:[{title:"名称",key:"name",type:"input"},{title:"是否成年",key:"isAge",type:"switch",config:{change(e){p.value.validateRow(e.record)}}},{title:"爱好",key:"like",type:"select"},{title:"操作",key:"operation",type:"slot",align:"center"}],fieldModel:{isForm:!1,config:{isForm:!0},optionsData:{isAge:[{label:"是",value:!0},{label:"否",value:!1}],like:[{label:"唱歌",value:"sing"},{label:"跳舞",value:"dance"}]},rules:{like:[{validator:async(e,A)=>p.value.resRules(e,A).record.isAge&&!A?Promise.reject(new Error("成年后爱好必填！")):Promise.resolve(!0),trigger:"change"}]},tableAttr:{pagination:!1}}});return a({originCode:"%3Ctemplate%3E%0A%20%20%3Cdiv%3E%0A%20%20%20%20%7B%7B%20tableData.tableData%20%7D%7D%0A%20%20%20%20%3CSTable%20ref%3D%22tableRef%22%20v-bind%3D%22tableData%22%3E%0A%20%20%20%20%20%20%3Ctemplate%20%23operationIn%3D%22data%22%3E%0A%20%20%20%20%20%20%20%20%3C!--%20%7B%7B%20data%20%7D%7D%20--%3E%0A%20%20%20%20%20%20%20%20%3Ca-space%3E%0A%20%20%20%20%20%20%20%20%20%20%3Ca-button%20v-if%3D%22!data.isEdit%22%20type%3D%22primary%22%20%40click%3D%22editRow(data)%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%3E%E7%BC%96%E8%BE%91%3C%2Fa-button%0A%20%20%20%20%20%20%20%20%20%20%3E%0A%20%20%20%20%20%20%20%20%20%20%3Ctemplate%20v-else%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Ca-button%20%40click%3D%22cancelRow(data)%22%3E%E5%8F%96%E6%B6%88%3C%2Fa-button%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Ca-button%20type%3D%22primary%22%20%40click%3D%22confirmRow(data)%22%3E%E4%BF%9D%E5%AD%98%3C%2Fa-button%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2Ftemplate%3E%0A%20%20%20%20%20%20%20%20%3C%2Fa-space%3E%0A%20%20%20%20%20%20%3C%2Ftemplate%3E%0A%20%20%20%20%3C%2FSTable%3E%0A%20%20%3C%2Fdiv%3E%0A%3C%2Ftemplate%3E%0A%3Cscript%20setup%20lang%3D%22ts%22%3E%0Aconst%20tableRef%20%3D%20ref()%0Aconst%20tableData%20%3D%20reactive(%7B%0A%20%20tableData%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20'wing'%2C%20isAge%3A%20false%2C%20like%3A%20undefined%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20'ring'%2C%20isAge%3A%20true%2C%20like%3A%20'sing'%20%7D%2C%0A%20%20%5D%2C%0A%20%20columns%3A%20%5B%0A%20%20%20%20%7B%20title%3A%20'%E5%90%8D%E7%A7%B0'%2C%20key%3A%20'name'%2C%20type%3A%20'input'%20%7D%2C%0A%20%20%20%20%7B%0A%20%20%20%20%20%20title%3A%20'%E6%98%AF%E5%90%A6%E6%88%90%E5%B9%B4'%2C%0A%20%20%20%20%20%20key%3A%20'isAge'%2C%0A%20%20%20%20%20%20type%3A%20'switch'%2C%0A%20%20%20%20%20%20config%3A%20%7B%0A%20%20%20%20%20%20%20%20change(data%3A%20any)%20%7B%0A%20%20%20%20%20%20%20%20%20%20tableRef.value.validateRow(data.record)%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%7D%2C%0A%20%20%20%20%7B%20title%3A%20'%E7%88%B1%E5%A5%BD'%2C%20key%3A%20'like'%2C%20type%3A%20'select'%20%7D%2C%0A%20%20%20%20%7B%20title%3A%20'%E6%93%8D%E4%BD%9C'%2C%20key%3A%20'operation'%2C%20type%3A%20'slot'%2C%20align%3A%20'center'%20%7D%2C%0A%20%20%5D%2C%0A%20%20fieldModel%3A%20%7B%0A%20%20%20%20isForm%3A%20false%2C%0A%20%20%20%20config%3A%20%7B%0A%20%20%20%20%20%20isForm%3A%20true%2C%0A%20%20%20%20%7D%2C%0A%20%20%20%20optionsData%3A%20%7B%0A%20%20%20%20%20%20isAge%3A%20%5B%0A%20%20%20%20%20%20%20%20%7B%20label%3A%20'%E6%98%AF'%2C%20value%3A%20true%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%20label%3A%20'%E5%90%A6'%2C%20value%3A%20false%20%7D%2C%0A%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20like%3A%20%5B%0A%20%20%20%20%20%20%20%20%7B%20label%3A%20'%E5%94%B1%E6%AD%8C'%2C%20value%3A%20'sing'%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%20label%3A%20'%E8%B7%B3%E8%88%9E'%2C%20value%3A%20'dance'%20%7D%2C%0A%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%7D%2C%0A%20%20%20%20rules%3A%20%7B%0A%20%20%20%20%20%20like%3A%20%5B%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20!%20%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81%0A%20%20%20%20%20%20%20%20%20%20async%20validator(rule%3A%20any%2C%20value%3A%20string)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20data%20%3D%20tableRef.value.resRules(rule%2C%20value)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.record.isAge%20%26%26%20!value)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20Promise.reject(new%20Error('%E6%88%90%E5%B9%B4%E5%90%8E%E7%88%B1%E5%A5%BD%E5%BF%85%E5%A1%AB%EF%BC%81'))%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20Promise.resolve(true)%0A%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20trigger%3A%20'change'%2C%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%7D%2C%0A%20%20%20%20tableAttr%3A%20%7B%0A%20%20%20%20%20%20pagination%3A%20false%2C%0A%20%20%20%20%7D%2C%0A%20%20%7D%2C%0A%7D)%0Afunction%20editRow(data%3A%20any)%20%7B%0A%20%20const%20%7B%20way%20%7D%20%3D%20data%0A%20%20way.update()%0A%7D%0Afunction%20cancelRow(data%3A%20any)%20%7B%0A%20%20const%20%7B%20way%20%7D%20%3D%20data%0A%20%20way.cancel()%0A%7D%0Afunction%20confirmRow(data%3A%20any)%20%7B%0A%20%20const%20%7B%20way%20%7D%20%3D%20data%0A%20%20way.validateRow().then((res%3A%20any)%20%3D%3E%20%7B%0A%20%20%20%20if%20(res.status)%20%7B%0A%20%20%20%20%20%20way.confirm()%0A%20%20%20%20%7D%0A%20%20%7D)%0A%7D%0A%0Aconst%20%24config%20%3D%20ref(%7B%0A%20%20title%3A%20'%E5%8A%A8%E6%80%81%E6%A0%A1%E9%AA%8C'%2C%0A%20%20order%3A%208%2C%0A%20%20context%3A%0A%20%20%20%20'%E5%8A%A8%E6%80%81%E6%A0%A1%E9%AA%8C%EF%BC%8C%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87validator%E6%96%B9%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%8A%A8%E6%80%81%E8%AE%BE%E7%BD%AE%EF%BC%8C%E5%8E%9F%E7%94%9F%E7%9A%84%E8%BF%99%E4%B8%AA%E6%96%B9%E6%B3%95%E6%B2%A1%E6%9C%89%E5%BD%93%E5%89%8D%E8%A1%8C%E7%9A%84%E4%BF%A1%E6%81%AF%EF%BC%8C%E8%BF%99%E9%87%8C%E5%8F%AF%E4%BB%A5%E5%80%9F%E5%8A%A9STable%E4%B8%AD%E5%B0%81%E8%A3%85%E7%9A%84resRules%E6%96%B9%E6%B3%95%EF%BC%8C%E8%A7%A3%E6%9E%90%E5%87%BA%E5%BD%93%E5%89%8D%E8%A1%8C%E7%9A%84%E4%BF%A1%E6%81%AF%E3%80%82%E6%8B%BF%E5%88%B0%E5%BD%93%E5%89%8D%E8%A1%8C%E7%9A%84%E4%BF%A1%E6%81%AF%E5%90%8E%E5%88%99%E5%8F%AF%E4%BB%A5%E5%8A%A8%E6%80%81%E8%AE%BE%E7%BD%AE%E4%BA%86%E3%80%82'%2C%0A%7D)%0AdefineExpose(%7B%0A%20%20%24config%2C%0A%7D)%0A%3C%2Fscript%3E%0A%3Cstyle%20scoped%20lang%3D%22scss%22%3E%3C%2Fstyle%3E%0A",$config:t({title:"动态校验",order:8,context:"动态校验，可以通过validator方法进行动态设置，原生的这个方法没有当前行的信息，这里可以借助STable中封装的resRules方法，解析出当前行的信息。拿到当前行的信息后则可以动态设置了。"})}),(A,a)=>{const t=i("a-button"),E=i("a-space"),F=e;return l(),n("div",null,[s(o(B(y).tableData)+" ",1),r(F,u({ref_key:"tableRef",ref:p},B(y)),{operationIn:C((e=>[c(" {{ data }} "),r(E,null,{default:C((()=>[e.isEdit?(l(),n(d,{key:1},[r(t,{onClick:A=>function(e){const{way:A}=e;A.cancel()}(e)},{default:C((()=>[s("取消")])),_:2},1032,["onClick"]),r(t,{type:"primary",onClick:A=>function(e){const{way:A}=e;A.validateRow().then((e=>{e.status&&A.confirm()}))}(e)},{default:C((()=>[s("保存")])),_:2},1032,["onClick"])],64)):(l(),D(t,{key:0,type:"primary",onClick:A=>function(e){const{way:A}=e;A.update()}(e)},{default:C((()=>[s("编辑")])),_:2},1032,["onClick"]))])),_:2},1024)])),_:1},16)])}}}),[["__file","/Users/wing/code/self/vue3-ant-dome-dos/src/views/stable/automation/dynamicRules.vue"]]);export{p as default};
